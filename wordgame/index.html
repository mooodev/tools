<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0f0f13">
    <title>В тему! — Словесная игра</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<!-- ===== START SCREEN ===== -->
<div class="screen active" id="start-screen">
    <div class="start-top">
        <div class="coins-display" id="home-coins">
            <span class="coin-icon">&#9679;</span>
            <span id="home-coins-val">0</span>
        </div>
        <button class="profile-btn" id="profile-btn" title="Профиль">
            <span id="home-avatar">&#128100;</span>
            <div class="lvl-ring"></div>
        </button>
    </div>

    <div class="start-hero">
        <div class="logo">В тему!</div>
        <p class="start-sub">Найди скрытые связи между словами. Сгруппируй 16 слов в 4 категории.</p>
    </div>

    <div class="xp-bar-wrap" id="home-xp-wrap">
        <div class="xp-label">
            <span id="home-lvl-label">Уровень 1</span>
            <span id="home-xp-label">0 / 200 XP</span>
        </div>
        <div class="xp-bar"><div class="xp-fill" id="home-xp-fill" style="width:0%"></div></div>
    </div>

    <div id="home-weekly" style="width:100%"></div>

    <div id="home-daily" style="width:100%"></div>

    <div id="bonus-words-section"></div>

    <div class="mode-section">
        <div class="mode-title">Выбери сложность</div>
        <div class="diff-grid" id="diff-grid"></div>
    </div>

    <div class="mode-section">
        <div class="mode-title">Режимы</div>
        <button class="mode-btn duel-mode-btn" id="duel-btn">&#9876; Дуэль</button>
        <button class="endless-btn" id="endless-btn">&#8734; Бесконечный режим</button>
    </div>

    <div class="mode-section">
        <div class="mode-title">Соревнование</div>
        <button class="mode-btn lb-mode-btn" id="lb-btn">&#127942; Лидерборд</button>
    </div>
</div>

<!-- ===== GAME SCREEN ===== -->
<div class="screen" id="game-screen">
    <div class="game-hdr">
        <div class="game-hdr-left">
            <button class="hdr-back" id="game-back">&#8592;</button>
            <span class="badge" id="game-badge"></span>
        </div>
        <div class="game-hdr-right">
            <span class="timer-display" id="timer-display">0:00</span>
            <span class="game-coins" id="game-coins">
                <span class="coin-icon">&#9679;</span>
                <span id="game-coins-val">0</span>
            </span>
        </div>
    </div>

    <div class="msg-bar"><div class="msg" id="msg"></div></div>

    <div class="board">
        <div class="solved-area" id="solved-area"></div>
        <div class="grid" id="grid"></div>
    </div>

    <div class="bottom-area">
        <div class="mistakes-row" id="mistakes-row"></div>
        <div class="hints-row">
            <button class="hint-btn" id="hint-explain" title="Объяснить значение слова (-1 звезда)">
                &#128218; Объяснить
                <span class="hint-cost" id="hint-explain-cost">20 &#9679;</span>
                <span class="hint-penalty">-1&#9733;</span>
            </button>
            <button class="hint-btn" id="hint-remove" title="Убрать одно лишнее слово (-1 звезда)">
                &#10060; Убрать лишнее
                <span class="hint-cost" id="hint-remove-cost">15 &#9679;</span>
                <span class="hint-penalty">-1&#9733;</span>
            </button>
        </div>
        <div class="ctrl-row">
            <button class="ctrl-btn" id="shuffle-btn">Перемешать</button>
            <button class="ctrl-btn" id="deselect-btn" disabled>Сбросить</button>
            <button class="ctrl-btn primary" id="submit-btn" disabled>Проверить</button>
        </div>
    </div>
</div>

<!-- ===== RESULT SCREEN ===== -->
<div class="screen" id="result-screen">
    <div class="result-icon" id="res-icon"></div>
    <div class="result-title" id="res-title"></div>
    <div class="stars-row" id="res-stars"></div>
    <div class="result-sub" id="res-sub"></div>
    <div class="result-stats" id="res-stats"></div>
    <div id="res-streak"></div>
    <div class="xp-gain" id="res-xp">
        <div class="xp-gain-left">Опыт</div>
        <div class="xp-gain-right" id="res-xp-val">+0 XP</div>
    </div>
    <div id="res-lvlup"></div>
    <div id="res-achievements"></div>
    <div id="res-daily"></div>
    <div id="res-duel"></div>
    <div class="share-row" id="res-share">
        <button class="share-btn share-btn-wide" id="share-img-btn" onclick="shareResultImage()">
            &#128228; Поделиться с друзьями
        </button>
    </div>
    <div class="result-actions" id="res-actions"></div>
</div>

<!-- ===== PROFILE SCREEN ===== -->
<div class="screen" id="profile-screen">
    <div class="hdr">
        <button class="hdr-back" id="profile-back">&#8592; Назад</button>
        <span class="hdr-title">Профиль</span>
        <span></span>
    </div>
    <div class="profile-card">
        <div class="profile-avatar">
            <span id="p-avatar">&#128100;</span>
            <span class="profile-level" id="p-level">1</span>
        </div>
        <div class="profile-name" id="p-name">Игрок</div>
        <div class="profile-xp-wrap">
            <div class="xp-label">
                <span id="p-lvl-label">Уровень 1</span>
                <span id="p-xp-label">0 / 200 XP</span>
            </div>
            <div class="xp-bar"><div class="xp-fill" id="p-xp-fill" style="width:0%"></div></div>
        </div>
        <div class="coins-display" style="font-size:16px">
            <span class="coin-icon">&#9679;</span>
            <span id="p-coins">0</span>
        </div>
    </div>
    <div class="profile-stats-grid" id="p-stats-grid"></div>
    <div class="section-title">Ежедневное</div>
    <div id="daily-panel"></div>
    <div class="section-title">Достижения</div>
    <div class="ach-list" id="ach-list"></div>
    <div style="height:8px"></div>
    <button class="pill-btn" id="archive-btn">&#128218; Архив паззлов</button>
    <button class="pill-btn" id="reset-btn" style="border-color:var(--error);color:var(--error);font-size:13px;margin-top:4px">Сбросить прогресс</button>
</div>

<!-- ===== ARCHIVE SCREEN ===== -->
<div class="screen" id="archive-screen">
    <div class="hdr">
        <button class="hdr-back" id="archive-back">&#8592; Назад</button>
        <span class="hdr-title">Архив</span>
        <span></span>
    </div>
    <div id="archive-content"></div>
</div>

<!-- ===== LEADERBOARD SCREEN ===== -->
<div class="screen" id="lb-screen">
    <div class="hdr">
        <button class="hdr-back" id="lb-back">&#8592; Назад</button>
        <span class="hdr-title">Лидерборд</span>
        <span></span>
    </div>
    <div class="lb-tabs" id="lb-tabs">
        <button class="lb-tab active" data-sort="xp" onclick="refreshLeaderboard('xp')">&#127941; Уровень</button>
        <button class="lb-tab" data-sort="streak" onclick="refreshLeaderboard('streak')">&#128293; Стрик</button>
        <button class="lb-tab" data-sort="stars" onclick="refreshLeaderboard('stars')">&#11088; Звёзды</button>
        <button class="lb-tab" data-sort="duels" onclick="refreshLeaderboard('duels')">&#9876; Дуэли</button>
    </div>
    <div class="lb-content" id="lb-content"></div>
    <button class="pill-btn share-lb-btn" id="share-lb-btn" onclick="shareLeaderboardPosition()">&#128228; Поделиться местом</button>
</div>

<!-- ===== DUEL PICK SCREEN ===== -->
<div class="screen" id="duel-pick-screen">
    <div class="hdr">
        <button class="hdr-back" id="duel-pick-back">&#8592; Назад</button>
        <span class="hdr-title">Дуэль</span>
        <span></span>
    </div>
    <div class="duel-pick-hero">
        <div class="duel-pick-icon">&#9876;</div>
        <div class="duel-pick-title">Режим дуэли</div>
        <div class="duel-pick-sub">Кто быстрее решит ту же сетку?<br>Выбери сложность для поиска соперника.</div>
    </div>
    <div class="diff-grid" id="duel-diff-grid"></div>
</div>

<!-- ===== DUEL SEARCH SCREEN ===== -->
<div class="screen" id="duel-search-screen">
    <div id="duel-search-content" class="duel-search-wrap"></div>
</div>

<!-- ===== Orientation Lock Overlay ===== -->
<div class="orientation-overlay" id="orientation-overlay">
    <div class="orient-icon">&#128241;</div>
    <div class="orient-text">Поверните устройство</div>
    <div class="orient-sub">Игра работает только в вертикальном режиме</div>
</div>

<!-- ===== Overlays & Effects ===== -->
<div class="combo-overlay" id="combo-overlay"></div>
<div class="confetti-container" id="confetti-container"></div>
<div class="toast-container" id="toast-container"></div>

<!-- ===== Scripts (order matters) ===== -->
<script src="/socket.io/socket.io.js"></script>
<script src="words.js"></script>
<script src="wordsunlocked.js"></script>
<script src="dailypuzzlewords.js"></script>
<script src="weeklypuzzlewords.js"></script>
<script src="meanings.js"></script>
<script src="save.js"></script>
<script src="telegram.js"></script>
<script src="puzzle-loader.js"></script>
<script src="audio.js"></script>
<script src="daily.js"></script>
<script src="leaderboard.js"></script>
<script src="share.js"></script>
<script src="duel.js"></script>
<script src="game.js"></script>
<script src="ui.js"></script>

</body>
</html>
